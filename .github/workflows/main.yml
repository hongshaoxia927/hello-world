name: deploy test
on: push

jobs: 
  deploy_job:
    runs-on: ubuntu-latest
    name: build & deploy
    steps:
      #拉取代码，安装依赖并进行编译 
      - name: checkout the code
        uses: actions/checkout@v2

      - name: install the dependencies
        run: npm install
      - name: build with the code
        run: npm run build

      #将编译完成的代码上传到服务器
      - name: upload built files to server
        uses: easingthemes/ssh-deploy@main
        env:
            SSH_PRIVATE_KEY: ${{ secrets.SERVER_SSH_KEY }}
            ARGS: -rltgoDzvO --delete
            SOURCE: ./docs/
            REMOTE_HOST: ${{ secrets.SERVER_IP }}
            REMOTE_USER: lighthouse
            TARGET: /home/lighthouse/deploy-test